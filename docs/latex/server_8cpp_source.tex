\hypertarget{server_8cpp_source}{}\subsection{server.\+cpp}
\label{server_8cpp_source}\index{src/server.cpp@{src/server.cpp}}
\mbox{\hyperlink{server_8cpp}{Documentation}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00001}00001 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00002}00002 \textcolor{comment}{ * @file server.cpp}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00003}00003 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00004}00004 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00005}00005 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00006}00006 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00007}00007 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00008}00008 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00009}00009 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00010}00010 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00011}00011 \textcolor{comment}{ * @see server.h}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00012}00012 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00014}00014 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00015}00015 \textcolor{preprocessor}{\#include "{}../include/server.h"{}}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00016}00016 \textcolor{preprocessor}{\#include "{}../include/session.h"{}}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00017}00017 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00018}00018 \textcolor{preprocessor}{\#include <sys/socket.h>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00019}00019 \textcolor{preprocessor}{\#include <netinet/in.h>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00020}00020 \textcolor{preprocessor}{\#include <unistd.h>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00021}00021 \textcolor{preprocessor}{\#include <cstring>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00022}00022 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00023}00023 \textcolor{preprocessor}{\#include <arpa/inet.h>}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00024}00024 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00025}00025 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00026}00026 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00027}00027 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00028}00028 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00029}00029 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00030}00030 \textcolor{comment}{ * @details}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00031}00031 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00032}00032 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00033}00033 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00034}00034 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00035}00035 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00036}00036 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00037}00037 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00038}00038 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00039}\mbox{\hyperlink{classServer_a47c127babad31cbd0a3c452d2e6b395b}{00039}} \mbox{\hyperlink{classServer_a47c127babad31cbd0a3c452d2e6b395b}{Server::Server}}(\textcolor{keyword}{const} \mbox{\hyperlink{structServerConfig}{ServerConfig}}\& config) }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00040}00040     : config\_(config), logger\_(config.log\_file), server\_fd\_(-\/1) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00041}00041     \mbox{\hyperlink{classServer_a0ed7695b528ccfab79656192533199c5}{load\_clients}}();}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00042}00042     \mbox{\hyperlink{classServer_a5165c8fc64601592b4ac2b46f2747737}{setup\_socket}}();}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00043}00043 \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00044}00044 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00045}00045 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00046}00046 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00047}00047 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00048}00048 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00049}00049 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00050}00050 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00051}\mbox{\hyperlink{classServer_a4b3aa2579cb1c8cd1d069582c14d0fa6}{00051}} \mbox{\hyperlink{classServer_a4b3aa2579cb1c8cd1d069582c14d0fa6}{Server::\string~Server}}() \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00052}00052     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}} > 0) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00053}00053         close(\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00054}00054     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00055}00055 \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00056}00056 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00057}00057 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00058}00058 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00059}00059 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00060}00060 \textcolor{comment}{ * @details}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00061}00061 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00062}00062 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00063}00063 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00064}00064 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00065}00065 \textcolor{comment}{ * alice:P@ssw0rd1}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00066}00066 \textcolor{comment}{ * bob:Secret123}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00067}00067 \textcolor{comment}{ * charlie:Qwerty!@\#}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00068}00068 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00069}00069 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00070}00070 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00071}00071 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00072}\mbox{\hyperlink{classServer_a0ed7695b528ccfab79656192533199c5}{00072}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classServer_a0ed7695b528ccfab79656192533199c5}{Server::load\_clients}}() \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00073}00073     std::ifstream file(\mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ad9468bbeb222fd74df00ef1fbbf7b87f}{client\_db\_file}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00074}00074     \textcolor{keywordflow}{if} (!file.is\_open()) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00075}00075         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Cannot open client database: "{}} + \mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ad9468bbeb222fd74df00ef1fbbf7b87f}{client\_db\_file}}, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00076}00076         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Cannot open client database"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00077}00077     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00078}00078     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00079}00079     std::string line;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00080}00080     \textcolor{keywordflow}{while} (std::getline(file, line)) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00081}00081         \textcolor{keywordtype}{size\_t} pos = line.find(\textcolor{charliteral}{':'});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00082}00082         \textcolor{keywordflow}{if} (pos != std::string::npos) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00083}00083             std::string login = line.substr(0, pos);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00084}00084             std::string password = line.substr(pos + 1);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00085}00085             \mbox{\hyperlink{classServer_a4d3082d5592ab7e53d2e37cbe1370575}{clients\_}}[login] = password;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00086}00086         \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00087}00087     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00088}00088     file.close();}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00089}00089     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00090}00090     \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a025725279def374c2a103331548b2631}{log}}(\textcolor{stringliteral}{"{}Loaded "{}} + std::to\_string(\mbox{\hyperlink{classServer_a4d3082d5592ab7e53d2e37cbe1370575}{clients\_}}.size()) + \textcolor{stringliteral}{"{} clients"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00091}00091 \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00092}00092 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00093}00093 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00094}00094 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00095}00095 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00096}00096 \textcolor{comment}{ * @details}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00097}00097 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00098}00098 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00099}00099 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00100}00100 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00101}00101 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00102}00102 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00103}00103 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00104}00104 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00105}\mbox{\hyperlink{classServer_a5165c8fc64601592b4ac2b46f2747737}{00105}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classServer_a5165c8fc64601592b4ac2b46f2747737}{Server::setup\_socket}}() \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00106}00106     \mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}} = socket(AF\_INET, SOCK\_STREAM, 0);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00107}00107     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}} < 0) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00108}00108         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Socket creation failed"{}}, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00109}00109         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Socket creation failed"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00110}00110     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00111}00111     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00112}00112     \textcolor{keywordtype}{int} opt = 1;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00113}00113     \textcolor{keywordflow}{if} (setsockopt(\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}}, SOL\_SOCKET, SO\_REUSEADDR, \&opt, \textcolor{keyword}{sizeof}(opt))) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00114}00114         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Setsockopt failed"{}}, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00115}00115         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Setsockopt failed"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00116}00116     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00117}00117     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00118}00118     \textcolor{keyword}{struct }sockaddr\_in address;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00119}00119     address.sin\_family = AF\_INET;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00120}00120     address.sin\_addr.s\_addr = INADDR\_ANY;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00121}00121     address.sin\_port = htons(\mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ae459946703124ef5a1d98dba38a8b493}{port}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00122}00122     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00123}00123     \textcolor{keywordflow}{if} (bind(\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}}, (\textcolor{keyword}{struct} sockaddr*)\&address, \textcolor{keyword}{sizeof}(address)) < 0) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00124}00124         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Bind failed on port "{}} + std::to\_string(\mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ae459946703124ef5a1d98dba38a8b493}{port}}), \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00125}00125         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Bind failed"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00126}00126     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00127}00127     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00128}00128     \textcolor{keywordflow}{if} (listen(\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}}, 10) < 0) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00129}00129         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Listen failed"{}}, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00130}00130         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Listen failed"{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00131}00131     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00132}00132     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00133}00133     \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a025725279def374c2a103331548b2631}{log}}(\textcolor{stringliteral}{"{}Server socket setup complete on port "{}} + std::to\_string(\mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ae459946703124ef5a1d98dba38a8b493}{port}}));}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00134}00134 \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00135}00135 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00136}00136 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00137}00137 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00138}00138 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00139}00139 \textcolor{comment}{ * @details}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00140}00140 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00141}00141 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00142}00142 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00143}00143 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00144}00144 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00145}00145 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00146}00146 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00147}00147 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00148}00148 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00149}\mbox{\hyperlink{classServer_ad4b5451852187a67551e68480fa0e9f5}{00149}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classServer_ad4b5451852187a67551e68480fa0e9f5}{Server::accept\_connections}}() \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00150}00150     \textcolor{keyword}{struct }sockaddr\_in address;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00151}00151     socklen\_t addrlen = \textcolor{keyword}{sizeof}(address);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00152}00152     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00153}00153     \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a025725279def374c2a103331548b2631}{log}}(\textcolor{stringliteral}{"{}Server started, waiting for connections..."{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00154}00154     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00155}00155     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00156}00156         \textcolor{keywordtype}{int} client\_socket = accept(\mbox{\hyperlink{classServer_a566cd5dd4c0933fb6132706cd12af23b}{server\_fd\_}}, (\textcolor{keyword}{struct} sockaddr*)\&address, \&addrlen);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00157}00157         \textcolor{keywordflow}{if} (client\_socket < 0) \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00158}00158             \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a0d807535d66747b03dced96d4e013a88}{log\_error}}(\textcolor{stringliteral}{"{}Accept failed"{}}, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00159}00159             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00160}00160         \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00161}00161         }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00162}00162         \textcolor{keywordtype}{char} client\_ip[INET\_ADDRSTRLEN];}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00163}00163         inet\_ntop(AF\_INET, \&address.sin\_addr, client\_ip, INET\_ADDRSTRLEN);}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00164}00164         \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a025725279def374c2a103331548b2631}{log}}(\textcolor{stringliteral}{"{}New connection from "{}} + std::string(client\_ip));}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00165}00165         }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00166}00166         \mbox{\hyperlink{classSession}{Session}} session(client\_socket, \mbox{\hyperlink{classServer_a4d3082d5592ab7e53d2e37cbe1370575}{clients\_}}, \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00167}00167         session.\mbox{\hyperlink{classSession_a72b04c0d0be04cba369af88f68c32296}{handle}}();}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00168}00168     \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00169}00169 \}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00170}00170 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00171}00171 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00172}00172 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00173}00173 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00174}00174 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00175}00175 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00176}00176 \textcolor{comment}{ * }}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00177}00177 \textcolor{comment}{Documentation}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00178}00178 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00179}\mbox{\hyperlink{classServer_abb27d30b40a94326e3fd629d3b30b7d5}{00179}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classServer_abb27d30b40a94326e3fd629d3b30b7d5}{Server::run}}() \{}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00180}00180     \mbox{\hyperlink{classServer_a65e2a0d098d668104f26a0a08092a28f}{logger\_}}.\mbox{\hyperlink{classLogger_a025725279def374c2a103331548b2631}{log}}(\textcolor{stringliteral}{"{}Server starting..."{}});}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00181}00181     std::cout << \textcolor{stringliteral}{"{}Server running on port "{}} << \mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ae459946703124ef5a1d98dba38a8b493}{port}} << std::endl;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00182}00182     std::cout << \textcolor{stringliteral}{"{}Client database: "{}} << \mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_ad9468bbeb222fd74df00ef1fbbf7b87f}{client\_db\_file}} << std::endl;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00183}00183     std::cout << \textcolor{stringliteral}{"{}Log file: "{}} << \mbox{\hyperlink{classServer_ad44296a781aa84fbc2cffee3407d9a25}{config\_}}.\mbox{\hyperlink{structServerConfig_a5728757aec9a966dbd50b52191438ca8}{log\_file}} << std::endl;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00184}00184     std::cout << \textcolor{stringliteral}{"{}Press Ctrl+C to stop"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00185}00185     }
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00186}00186     \mbox{\hyperlink{classServer_ad4b5451852187a67551e68480fa0e9f5}{accept\_connections}}();}
\DoxyCodeLine{\Hypertarget{server_8cpp_source_l00187}00187 \}}

\end{DoxyCode}
